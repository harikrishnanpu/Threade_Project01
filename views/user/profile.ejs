<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Personal data – <%= user.name %></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

  <style>
    :root{
      --bg:#f7f9fc;--white:#fff;--primary:#000;--primary-light:#e8f0ff;
      --text:#374151;--muted:#6b7280;--radius:12px;--tr:.25s;
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",sans-serif}
    body{background:var(--bg);color:var(--text);line-height:1.5}

    /* layout */
    .wrapper{display:flex;min-height:100dvh;max-width:1300px;margin:auto}

    /* sidebar */
    .sidebar{
      width:250px;background:var(--white);border-right:1px solid #e5e7eb;
      display:flex;flex-direction:column;padding:1.5rem 0;transition:transform var(--tr)
    }
    .avatar-box{display:flex;align-items:center;gap:.9rem;padding-inline:1.5rem;margin-bottom:1.6rem}
    .avatar{
      padding-inline:10px;padding-block:5px;border-radius:50%;background:var(--primary-light);
      display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:600;color:var(--primary)
    }
    nav ul{list-style:none}
    nav li a{
      display:flex;align-items:center;gap:.75rem;padding:.85rem 1.5rem;text-decoration:none;color:inherit;
      border-left:3px solid transparent;transition:background var(--tr)
    }
    nav li a:hover{background:#f1f5f9}
    nav li a.active{border-color:var(--primary);background:#eef4ff}
    nav li i{width:18px;text-align:center}
    .logout{margin-top:auto;padding:.9rem 1.5rem;background:none;border:none;color:#ef4444;display:flex;gap:.6rem;cursor:pointer}

    /* mobile header */
    .mobile-top{
      display:none;background:var(--white);border-bottom:1px solid #e5e7eb;
      padding:1rem 1.25rem;align-items:center;justify-content:space-between;position:sticky;top:0
    }
    .mobile-btn{background:none;border:none;font-size:1.3rem}
    .overlay{display:none;position:fixed;inset:0;background:#0005;z-index:800}

    /* main */
    main{flex:1;padding:2rem 2.5rem}
    h1{font-size:1.4rem;margin-bottom:1.4rem}
    .crumb{font-size:.85rem;color:var(--muted);margin-bottom:1.2rem}
    .crumb i{margin-inline:.25rem}

    /* profile top */
    .profile-top{display:flex;align-items:center;gap:1.2rem;margin-bottom:1.8rem}
    .big-avatar{
      width:90px;height:90px;border-radius:50%;background:var(--primary-light);
      display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:600;color:var(--primary)
    }

    /* info grid */
    .info-grid{
      display:grid;gap:1.2rem;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr))
    }
    .info-block{}
    .profile-label{
      font-size:.75rem;font-weight:600;color:var(--muted);margin-bottom:.25rem
    }
    .profile-value{
      font-size:1rem;color:var(--text);word-break:break-word
    }
    .profile-code{
      font-family:monospace;background:var(--primary-light);padding:.4rem .6rem;border-radius:6px
    }

    /* share + edit */
    .action-row{margin-top:2rem;display:flex;flex-wrap:wrap;gap:1rem}
    .action-btn{
      display:inline-flex;align-items:center;gap:.4rem;padding:.7rem 1.5rem;background:var(--primary);
      color:var(--white);border:none;border-radius:var(--radius);font-size:.9rem;cursor:pointer;
      transition:background var(--tr),transform var(--tr);text-decoration:none
    }
    .action-btn:hover{background:#0b5be0;transform:translateY(-2px)}

    /* responsive */
    @media(max-width:768px){
      .sidebar{position:fixed;inset:0 50% 0 0;transform:translateX(-100%);z-index:850}
      .sidebar.open{transform:none}
      .mobile-top{display:flex}
      .wrapper{flex-direction:column}
      main{padding:1.25rem;margin-top:64px}
      .overlay.show{display:block}
    }
  </style>
</head>
<body>
  <!-- mobile header -->
  <div class="mobile-top">
    <button class="mobile-btn" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
    <span>Personal data</span><span></span>
  </div>
  <div class="overlay" onclick="toggleMenu()"></div>

  <div class="wrapper">
    <!-- sidebar -->
    <aside class="sidebar" id="side">
      <div class="avatar-box">
        <div class="avatar"><%= user.name[0].toUpperCase() %></div>
        <div>
          <strong><%= user.name %></strong><br/>
          <span style="font-size:.8rem;color:var(--muted)"><%= user.email %></span>
        </div>
      </div>
      <nav>
        <ul>
          <li><a class="active" href="/user/profile"><i class="fas fa-user"></i>Personal data</a></li>
          <li><a href="/user/profile/address"><i class="fas fa-map-marker-alt"></i>Addresses</a></li>
          <li><a href="/user/profile/orders"><i class="fas fa-box"></i>Orders</a></li>
                    <li><a  href="/user/profile/wallet"><i class="fas fa-wallet"></i>Wallet</a></li>
          <li><a href="/contact-us"><i class="fas fa-phone"></i>Contact us</a></li>
        </ul>
      </nav>
      <button class="logout" onclick="location.href='/logout'"><i class="fas fa-right-from-bracket"></i> Log out</button>
    </aside>

    <!-- main -->
    <main>
      <div class="crumb"><i class="fas fa-house"></i> Home › Account › Personal</div>
      <h1>Profile details</h1>

      <!-- profile image -->
      <div class="profile-top">
        <% if(user.profileImage){ %>
          <img src="<%= user.profileImage %>" alt="profile" class="big-avatar" style="object-fit:cover"/>
        <% }else{ %>
          <div class="big-avatar"><%= user.name[0].toUpperCase() %></div>
        <% } %>
        <div>
          <strong style="font-size:1.2rem"><%= user.name %></strong><br/>
          <span style="color:var(--muted)"><%= user.email %></span>
        </div>
      </div>

      <!-- info -->
      <div class="info-grid">
        <div class="info-block">
          <p class="profile-label">Full name</p>
          <p class="profile-value"><%= user.name %></p>
        </div>
        <div class="info-block">
          <p class="profile-label">E-mail</p>
          <p class="profile-value"><%= user.email %></p>
        </div>
        <div class="info-block">
          <p class="profile-label">Phone</p>
          <p class="profile-value"><%= user.phone || '—' %></p>
        </div>
        <div class="info-block">
          <p class="profile-label">Date of birth</p>
          <p class="profile-value"><%= user.dateOfBirth ? user.dateOfBirth.toISOString().slice(0,10) : '—' %></p>
        </div>
        <div class="info-block">
          <p class="profile-label">Status</p>
          <p class="profile-value"><%= user.isVerified ? 'Verified' : 'Unverified' %></p>
        </div>
        <div class="info-block">
          <p class="profile-label">Referral code</p>
          <p class="profile-value profile-code"><%= user.referralCode %></p>
        </div>
      </div>

      <!-- actions -->
      <div class="action-row">
        <button class="action-btn" onclick="copyReferral()"><i class="fas fa-copy"></i>Copy referral link</button>
        <a class="action-btn" href="/user/profile/edit"><i class="fas fa-pen"></i>Edit profile</a>
      </div>
    </main>
  </div>

  <script>
    function toggleMenu(){
      document.getElementById('side').classList.toggle('open');
      document.querySelector('.overlay').classList.toggle('show');
    }

    function copyReferral(){
      const link = `${location.origin}/user/register?referral=<%= user.referralCode %>`;
      navigator.clipboard.writeText(link).then(()=>{
        showGlobalToast('refferal link copied')
      }).catch(()=> showGlobalToast('failed to copy')
    );
    }
  </script>
</body>
</html>
