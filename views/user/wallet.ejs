<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Wallet – <%= user.name %></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

  <style>
    :root{
      --bg:#f7f9fc;--white:#fff;--primary:#000;
      --text:#374151;--muted:#6b7280;--radius:12px;--tr:.25s;
      --credit:#10b981;--debit:#ef4444;
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",sans-serif}
    body{background:var(--bg);color:var(--text);line-height:1.5}

    /* layout */
    .wrapper{display:flex;min-height:100dvh;max-width:1300px;margin:auto}

    /* sidebar */
    .sidebar{
      width:250px;background:var(--white);border-right:1px solid #e5e7eb;
      display:flex;flex-direction:column;padding:1.5rem 0;transition:transform var(--tr)
    }
    .avatar-box{display:flex;align-items:center;gap:.9rem;padding-inline:1.5rem;margin-bottom:1.6rem}
    .avatar{
      padding:5px 10px;border-radius:50%;background:#e8f0ff;
      display:flex;align-items:center;justify-content:center;font-size:1.25rem;font-weight:600;color:var(--primary)
    }
    nav ul{list-style:none}
    nav li a{display:flex;align-items:center;gap:.75rem;padding:.85rem 1.5rem;text-decoration:none;color:inherit;border-left:3px solid transparent;transition:background var(--tr)}
    nav li a:hover{background:#f1f5f9}
    nav li a.active{border-color:var(--primary);background:#eef4ff}
    nav li i{width:18px;text-align:center}
    .logout{margin-top:auto;padding:.9rem 1.5rem;background:none;border:none;color:#ef4444;display:flex;gap:.6rem;cursor:pointer}

    /* mobile header */
    .mobile-top{display:none;background:var(--white);border-bottom:1px solid #e5e7eb;padding:1rem 1.25rem;align-items:center;justify-content:space-between;position:sticky;top:0}
    .mobile-btn{background:none;border:none;font-size:1.3rem}
    .overlay{display:none;position:fixed;inset:0;background:#0005;z-index:800}

    /* main */
    main{flex:1;padding:2rem 2.5rem}
    h1{font-size:1.4rem;margin-bottom:1.4rem}
    .crumb{font-size:.85rem;color:var(--muted);margin-bottom:1.2rem}
    .crumb i{margin-inline:.25rem}

    /* wallet cards */
    .card{background:var(--white);border:1px solid #e5e7eb;border-radius:var(--radius);overflow:hidden}
    .card-header{padding:1.25rem;border-bottom:1px solid #f3f4f6;font-weight:600;font-size:1rem;display:flex;align-items:center;gap:.6rem}
    .card-body{padding:1.25rem}

    .balance-display{font-size:2rem;font-weight:700;margin-bottom:.2rem}
    .balance-sub{color:var(--muted);font-size:.9rem}

    /* transaction list */
    .txn-list{display:flex;flex-direction:column;gap:.9rem}
    .txn-item{display:flex;gap:1rem;border:1px solid #f3f4f6;border-radius:8px;padding:1rem;align-items:center;background:var(--white);transition:background var(--tr)}
    .txn-item:hover{background:#fafbfc}
    .txn-icon{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;color:#fff;flex-shrink:0}
    .txn-icon.credit{background:var(--credit)}
    .txn-icon.debit{background:var(--debit)}
    .txn-info{flex:1}
    .txn-desc{font-weight:600;margin-bottom:.15rem}
    .txn-meta{font-size:.8rem;color:var(--muted)}
    .txn-amt{font-weight:700}
    .txn-amt.credit{color:var(--credit)}
    .txn-amt.debit{color:var(--debit)}

    /* responsive */
    @media(max-width:768px){
      .sidebar{position:fixed;inset:0 50% 0 0;transform:translateX(-100%);z-index:850}
      .sidebar.open{transform:none}
      .mobile-top{display:flex}
      .wrapper{flex-direction:column}
      main{padding:1.25rem;margin-top:64px}
      .overlay.show{display:block}
      .txn-item{flex-direction:column;align-items:flex-start}
      .txn-amt{margin-top:.4rem}
    }
  </style>
</head>
<body>

  <!-- mobile header -->
  <div class="mobile-top">
    <button class="mobile-btn" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
    <span>Wallet</span><span></span>
  </div>
  <div class="overlay" onclick="toggleMenu()"></div>

  <div class="wrapper">
    <!-- sidebar -->
    <aside class="sidebar" id="side">
      <div class="avatar-box">
        <div class="avatar"><%= user.name[0].toUpperCase() %></div>
        <div>
          <strong><%= user.name %></strong><br>
          <span style="font-size:.8rem;color:var(--muted)"><%= user.email %></span>
        </div>
      </div>
      <nav>
        <ul>
          <li><a href="/user/profile"><i class="fas fa-user"></i>Personal data</a></li>
          <li><a href="/user/profile/address"><i class="fas fa-map-marker-alt"></i>Addresses</a></li>
          <li><a href="/user/profile/orders"><i class="fas fa-box"></i>Orders</a></li>
          <li><a class="active" href="/user/profile/wallet"><i class="fas fa-wallet"></i>Wallet</a></li>
          <li><a href="/contact-us"><i class="fas fa-phone"></i>Contact us</a></li>
        </ul>
      </nav>
      <button class="logout" onclick="location.href='/logout'"><i class="fas fa-right-from-bracket"></i> Log out</button>
    </aside>

    <!-- main -->
    <main>
      <div class="crumb"><i class="fas fa-house"></i> Home › Account › Wallet</div>
      <h1>Wallet</h1>

      <!-- balance card -->
      <div class="card" style="margin-bottom:1.5rem">
        <div class="card-header"><i class="fas fa-wallet"></i> Current Balance</div>
        <div class="card-body">
          <div class="balance-display">₹<%= wallet.balance.toFixed(2) %></div>
          <div class="balance-sub">Updated on <%= new Date(wallet.updatedAt).toLocaleDateString('en-IN',{year:'numeric',month:'long',day:'numeric'}) %></div>
        </div>
      </div>

      <!-- transactions card -->
      <div class="card">
        <div class="card-header"><i class="fas fa-receipt"></i> Transactions</div>
        <div class="card-body">
          <% if(wallet.transactions.length){ %>
            <div class="txn-list">
              <% wallet.transactions.slice().reverse().forEach(txn=>{ %>
                <div class="txn-item">
                  <div class="txn-icon <%= txn.type %>">
                    <i class="fas <%= txn.type==='credit'?'fa-arrow-down':'fa-arrow-up' %>"></i>
                  </div>
                  <div class="txn-info">
                    <div class="txn-desc"><%= txn.description %></div>
                    <div class="txn-meta">
                      <%= new Date(txn.createdAt).toLocaleDateString('en-IN',{year:'numeric',month:'short',day:'numeric'}) %> •
                      Ref: <%= txn.reference || '—' %>
                    </div>
                  </div>
                  <div class="txn-amt <%= txn.type %>">
                    <%= txn.type==='credit' ? '+' : '-' %>₹<%= txn.amount.toFixed(2) %>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } else { %>
            <p style="color:var(--muted);text-align:center">No transactions yet.</p>
          <% } %>
        </div>
      </div>
    </main>
  </div>

  <script>
    function toggleMenu(){
      document.getElementById('side').classList.toggle('open');
      document.querySelector('.overlay').classList.toggle('show');
    }
  </script>
</body>
</html>
