
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">


  <link rel="stylesheet" href="/landing/css/style-prefix.css">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  
  <style>
    :root {
      --primary: #000;
      --secondary: #6c757d;
      --light-gray: #f8f9fa;
      --border: #e9ecef;
      --text-muted: #6c757d;
      --text-dark: #212529;
      --radius: 8px;
      --shadow: 0 2px 8px rgba(0,0,0,0.08);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.12);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --success: #10b981;
      --error: #ef4444;
      --warning: #f59e0b;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    a h2{
      color: #000 !important;
    }

    a{
      text-decoration: none;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 14px;
      color: var(--text-dark);
      background: #fafafa;
      line-height: 1.6;
      font-weight: 400;
    }

    /* Layout */
    .main-container {
      display: flex;
      min-height: 100vh;
      background: #fff;
    }

    /* Sidebar */
    .sidebar {
      width: 280px;
      background: #fff;
      border-right: 1px solid var(--border);
      padding: 2rem 0;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      transition: var(--transition);
    }

    .sidebar-header {
      padding: 0 2rem 2rem;
      border-bottom: 1px solid var(--border);
      margin-bottom: 2rem;
    }

    .sidebar-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .sidebar-subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .sidebar-nav {
      padding: 0 1rem;
    }

    .nav-item {
      margin-bottom: 0.5rem;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      color: var(--text-muted);
      text-decoration: none;
      border-radius: var(--radius);
      transition: var(--transition);
      font-weight: 500;
    }

    .nav-link:hover,
    .nav-link.active {
      background: var(--light-gray);
      color: var(--primary);
    }

    .nav-link.active {
      background: var(--primary);
      color: #fff;
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }

    /* Mobile Sidebar Toggle */
    .sidebar-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
      background: var(--primary);
      color: #fff;
      border: none;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      box-shadow: var(--shadow-lg);
      transition: var(--transition);
        align-items: center;
        justify-content: center;
    }

    .sidebar-toggle:hover {
      transform: scale(1.05);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 2rem;
      overflow-x: hidden;
    }

    /* Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .page-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .page-subtitle {
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    .header-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    /* Wishlist Stats */
    .wishlist-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: #fff;
      padding: .5rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      transition: var(--transition);
    }

    .stat-card:hover {
      box-shadow: var(--shadow);
      transform: translateY(-2px);
    }

    .stat-number {
      font-size: 1rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 0.875rem;
      font-weight: 500;
    }

    /* Action Buttons */
    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius);
      font-size: 0.875rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      justify-content: center;
    }

    .btn-primary {
      background: var(--primary);
      color: #fff;
    }

    .btn-primary:hover:not(:disabled) {
      background: #333;
      transform: translateY(-1px);
    }

    .btn-outline {
      background: transparent;
      color: var(--primary);
      border: 1px solid var(--border);
    }

    .btn-outline:hover:not(:disabled) {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }

    .btn-danger {
      background: var(--error);
      color: #fff;
    }

    .btn-danger:hover:not(:disabled) {
      background: #dc2626;
      transform: translateY(-1px);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none !important;
    }

    .btn-sm {
      padding: 0.5rem 1rem;
      font-size: 0.8125rem;
    }

    /* Wishlist Grid */
    .wishlist-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    /* Wishlist Item Card */
    .wishlist-item {
      background: #fff;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
      transition: var(--transition);
      position: relative;
      animation: fadeInUp 0.5s ease-out;
    }

    .wishlist-item:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-4px);
    }

    .wishlist-item.removing {
      animation: fadeOutScale 0.3s ease-in forwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeOutScale {
      to {
        opacity: 0;
        transform: scale(0.9);
      }
    }

    .item-image-container {
      position: relative;
      aspect-ratio: 1;
      overflow: hidden;
      background: var(--light-gray);
    }

    .item-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .wishlist-item:hover .item-image {
      transform: scale(1.05);
    }

    .item-badge {
      position: absolute;
      top: 0.75rem;
      left: 0.75rem;
      background: var(--error);
      color: #fff;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .item-badge.in-stock {
      background: var(--success);
    }

    .item-badge.low-stock {
      background: var(--warning);
    }

    .remove-btn {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      width: 36px;
      height: 36px;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      opacity: 0;
      transform: scale(0.8);
    }

    .wishlist-item:hover .remove-btn {
      opacity: 1;
      transform: scale(1);
    }

    .remove-btn:hover {
      background: var(--error);
      color: #fff;
      transform: scale(1.1);
    }

    .item-content {
      padding: 1.5rem;
    }

    .item-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .item-brand {
      font-size: 0.875rem;
      color: var(--text-muted);
      margin-bottom: 0.75rem;
    }

    .item-price {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .current-price {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--primary);
    }

    .original-price {
      font-size: 1rem;
      color: var(--text-muted);
      text-decoration: line-through;
    }

    .discount-badge {
      background: var(--error);
      color: #fff;
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .item-variants {
      margin-bottom: 1rem;
    }

    .variant-info {
      display: flex;
      gap: 1rem;
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .variant-item {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .color-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 1px solid var(--border);
    }

    .item-actions {
      display: flex;
      gap: 0.75rem;
    }

    .btn-add-cart {
      flex: 1;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      background: #fff;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .empty-icon {
      font-size: 4rem;
      color: var(--text-muted);
      margin-bottom: 1rem;
    }

    .empty-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }

    .empty-subtitle {
      color: var(--text-muted);
      margin-bottom: 2rem;
    }

    /* Loading States */
    .loading-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .skeleton-item {
      background: #fff;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
    }

    .skeleton-image {
      aspect-ratio: 1;
      background: var(--light-gray);
    }

    .skeleton-content {
      padding: 1.5rem;
    }

    .skeleton-line {
      height: 1rem;
      background: var(--light-gray);
      border-radius: 4px;
      margin-bottom: 0.75rem;
    }

    .skeleton-line.short {
      width: 60%;
    }

    .skeleton-line.medium {
      width: 80%;
    }

    /* Notifications */
    .notification {
      position: fixed;
      top: 2rem;
      right: 2rem;
      z-index: 9999;
      min-width: 320px;
      max-width: 480px;
      padding: 1rem 1.5rem;
      border-radius: var(--radius);
      font-size: 0.875rem;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      animation: slideInRight 0.3s ease-out;
    }

    @keyframes slideInRight {
      from {
        opacity: 0;
        transform: translateX(100%);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .notification.success {
      background: #ecfdf5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }

    .notification.error {
      background: #fef2f2;
      color: #991b1b;
      border: 1px solid #fecaca;
    }

    .notification.warning {
      background: #fffbeb;
      color: #92400e;
      border: 1px solid #fed7aa;
    }

    .notification-icon {
      flex-shrink: 0;
    }

    .notification-close {
      margin-left: auto;
      background: none;
      border: none;
      cursor: pointer;
      opacity: 0.7;
      transition: var(--transition);
    }

    .notification-close:hover {
      opacity: 1;
    }

    /* Modal Improvements */
    .modal-content {
      border: none;
      border-radius: var(--radius);
      box-shadow: var(--shadow-lg);
    }

    .modal-header {
      border-bottom: 1px solid var(--border);
      padding: 1.5rem 2rem;
      background: var(--light-gray);
    }

    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-dark);
    }

    .modal-body {
      padding: 2rem;
    }

    .modal-footer {
      border-top: 1px solid var(--border);
      padding: 1.5rem 2rem;
      background: var(--light-gray);
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .sidebar {
        width: 240px;
      }
      
      .wishlist-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        left: -280px;
        z-index: 999;
        box-shadow: var(--shadow-lg);
      }

      .sidebar.open {
        left: 0;
      }

      .sidebar-toggle {
        display: flex;
      }

      .main-content {
        padding: 1rem;
        margin-left: 0;
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }

      .header-actions {
        width: 100%;
        justify-content: space-between;
      }

      .wishlist-stats {
        grid-template-columns: repeat(2, 1fr);
      }

      .wishlist-grid {
        grid-template-columns: 1fr;
      }

      .notification {
        top: 1rem;
        right: 1rem;
        left: 1rem;
        min-width: auto;
      }
    }

    @media (max-width: 480px) {
      .main-content {
        padding: 0.75rem;
      }

      .wishlist-stats {
        grid-template-columns: 1fr;
      }

      .item-content {
        padding: 1rem;
      }

      .item-actions {
        flex-direction: column;
      }

      .modal-header,
      .modal-body,
      .modal-footer {
        padding: 1rem 1.5rem;
      }
    }

    /* Utility Classes */
    .text-muted { color: var(--text-muted) !important; }
    .text-dark { color: var(--text-dark) !important; }
    .fw-medium { font-weight: 500 !important; }
    .fw-semibold { font-weight: 600 !important; }
    .d-none { display: none !important; }
    .d-block { display: block !important; }
  </style>
</head>
<body>

<div class="main-container">
  <!-- Sidebar Toggle for Mobile -->
  <button class="sidebar-toggle" id="sidebarToggle">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2 class="sidebar-title">My Account</h2>
      <p class="sidebar-subtitle">Manage your preferences</p>
    </div>
    
    <nav class="sidebar-nav">
      <div class="nav-item">
        <a href="/user/profile" class="nav-link">
          <i class="fas fa-user nav-icon"></i>
          Profile
        </a>
      </div>
      <div class="nav-item">
        <a href="/user/orders" class="nav-link">
          <i class="fas fa-shopping-bag nav-icon"></i>
          Orders
        </a>
      </div>
      <div class="nav-item">
        <a href="/user/wishlist" class="nav-link active">
          <i class="fas fa-heart nav-icon"></i>
          Wishlist
        </a>
      </div>
      <div class="nav-item">
        <a href="/user/addresses" class="nav-link">
          <i class="fas fa-map-marker-alt nav-icon"></i>
          Addresses
        </a>
      </div>
      <div class="nav-item">
        <a href="/user/settings" class="nav-link">
          <i class="fas fa-cog nav-icon"></i>
          Settings
        </a>
      </div>
      <div class="nav-item">
        <a href="/user/logout" class="nav-link">
          <i class="fas fa-sign-out-alt nav-icon"></i>
          Logout
        </a>
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <div>
        <h1 class="page-title">My Wishlist</h1>
        <p class="page-subtitle">Items you've saved for later</p>
      </div>
      <div class="header-actions">
        <% if (wishlistItems && wishlistItems.length > 0) { %>
          <button onclick="clearAllWishlist()" class="btn btn-outline btn-sm" id="clearAllBtn">
            <i class="fas fa-trash"></i>
            Clear All
          </button>
        <% } %>
      </div>
    </div>

    <!-- Wishlist Stats -->
    <% if (wishlistItems && wishlistItems.length > 0) { %>
    <div class="wishlist-stats">
      <div class="stat-card">
        <div class="stat-number"><%= wishlistItems.length %></div>
        <div class="stat-label">Total Items</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">
          <% 
            const inStockItems = wishlistItems.filter(item => 
              item.product && item.product.stock > 0
            ).length;
          %>
          <%= inStockItems %>
        </div>
        <div class="stat-label">In Stock</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">
          ₹<%= wishlistItems.reduce((total, item) => {
            if (item.product) {
              const price = item.product.salePrice > 0 ? item.product.salePrice : item.product.regularPrice;
              return total + price;
            }
            return total;
          }, 0).toLocaleString('en-IN') %>
        </div>
        <div class="stat-label">Total Value</div>
      </div>
    </div>
    <% } %>

    <!-- Wishlist Items -->
    <div id="wishlistContainer">
      <% if (wishlistItems && wishlistItems.length > 0) { %>

                  <div class="product-grid">
          <% wishlistItems.forEach((item, index) => { %>
            <% if (item.product) { %>
                        <div class="showcase">
                          <div class="showcase-banner">
                            <img src="<%= item.product.images[0] %>" alt="product" width="300" class="product-img default">
                            <img src="<%= item.product.images[1] %>" alt="product" width="300" class="product-img hover">
                            <p class="showcase-badge">15%</p>
                            <div class="showcase-actions">
                              <button class="btn-action"><ion-icon name="heart-outline"></ion-icon></button>
                              <button class="btn-action"><ion-icon name="eye-outline"></ion-icon></button>
                              <button class="btn-action"><ion-icon name="repeat-outline"></ion-icon></button>
                              <button class="btn-action"><ion-icon name="bag-add-outline"></ion-icon></button>
                            </div>
                          </div>
                          <div class="showcase-content">
                            <a href="<%= `/user/products/${item.product._id}` %>" class="showcase-category"><%= item.product.category.name %></a>
                            <a href="<%= `/user/products/${item.product._id}` %>"><h3 class="showcase-title text-truncate"><%= item.product.name %></h3></a>
                            <div class="showcase-rating"><ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon><ion-icon name="star"></ion-icon><ion-icon name="star-outline"></ion-icon><ion-icon name="star-outline"></ion-icon></div>
                            <div class="price-box"><p class="price">₹<%= item.product.regularPrice %></p><del>₹<%= item.product.salePrice %></del></div>
                            <div class="product-actions d-flex mb-2">
                              <div>
                                <a onclick="showVariantSidebar('<%= item.product._id %>')" style="color:#fff;" class="action-btn btn-dark text-truncate" href="javascript:void(0);">Add to cart 
                                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.31641 3.25C1.90219 3.25 1.56641 3.58579 1.56641 4C1.56641 4.41421 1.90219 4.75 2.31641 4.75H3.49696C3.87082 4.75 4.18759 5.02534 4.23965 5.39556L5.49371 14.3133C5.6499 15.424 6.60021 16.25 7.72179 16.25L18.0664 16.25C18.4806 16.25 18.8164 15.9142 18.8164 15.5C18.8164 15.0858 18.4806 14.75 18.0664 14.75L7.72179 14.75C7.34793 14.75 7.03116 14.4747 6.9791 14.1044L6.85901 13.2505H17.7114C18.6969 13.2505 19.5678 12.6091 19.8601 11.668L21.7824 5.48032C21.8531 5.25268 21.8114 5.00499 21.6701 4.81305C21.5287 4.62112 21.3045 4.50781 21.0662 4.50781H5.51677C5.14728 3.75572 4.37455 3.25 3.49696 3.25H2.31641ZM5.84051 6.00781L6.64807 11.7505H17.7114C18.0399 11.7505 18.3302 11.5367 18.4277 11.223L20.0478 6.00781H5.84051Z" fill="#fff"/><path d="M7.78418 17.75C6.81768 17.75 6.03418 18.5335 6.03418 19.5C6.03418 20.4665 6.81768 21.25 7.78418 21.25C8.75068 21.25 9.53428 20.4665 9.53428 19.5C9.53428 18.5335 8.75068 17.75 7.78418 17.75Z" fill="#fff"/><path d="M14.5703 19.5C14.5703 18.5335 15.3538 17.75 16.3203 17.75C17.2868 17.75 18.0704 18.5335 18.0704 19.5C18.0704 20.4665 17.2869 21.25 16.3204 21.25C15.3539 21.25 14.5703 20.4665 14.5703 19.5Z" fill="#fff"/></svg>
                                </a>
                              </div>
                              <div  class="whishlist-page-icon <%= wishlistItemIds.includes(item.product._id.toString()) ? 'active pulse-continuous' : '' %>" data-product-id="<%= item.product._id %>">
                                <svg width="24" height="24" viewBox="0 0 24 24"><path d="M11.8227 4.77124L12 4.94862L12.1773 4.77135C14.4244 2.52427 18.0676 2.52427 20.3147 4.77134C22.5618 7.01842 22.5618 10.6616 20.3147 12.9087L13.591 19.6324C12.7123 20.5111 11.2877 20.5111 10.409 19.6324L3.6853 12.9086C1.43823 10.6615 1.43823 7.01831 3.6853 4.77124C5.93237 2.52417 9.5756 2.52417 11.8227 4.77124Z" stroke-width="1.8" stroke="<%= wishlistItemIds.includes(item.product._id.toString()) ? '#e63946' : '#000' %>" fill="<%= wishlistItemIds.includes(item.product._id.toString()) ? '#e63946' : 'none' %>"></path></svg>
                              </div>
                            </div>
                          </div>
                        </div>
            <% } %>
          <% }); %>
        </div>
      <% } else { %>
        <!-- Empty State -->
        <div class="empty-state">
          <div class="empty-icon">
            <i class="far fa-heart"></i>
          </div>
          <h2 class="empty-title">Your wishlist is empty</h2>
          <p class="empty-subtitle">
            Save items you love to your wishlist and never lose track of them.
          </p>
          <a href="/user/products/shop" class="btn btn-primary">
            <i class="fas fa-shopping-bag"></i>
            Start Shopping
          </a>
        </div>
      <% } %>
    </div>

    <!-- Loading State (Hidden by default) -->
    <div class="wishlist-grid d-none" id="loadingGrid">
      <% for (let i = 0; i < 6; i++) { %>
        <div class="skeleton-item">
          <div class="skeleton-image loading-skeleton"></div>
          <div class="skeleton-content">
            <div class="skeleton-line loading-skeleton"></div>
            <div class="skeleton-line short loading-skeleton"></div>
            <div class="skeleton-line medium loading-skeleton"></div>
          </div>
        </div>
      <% } %>
    </div>
  </main>
</div>




<div id="wishlistClearAllConfirmModal" class="wishlist-confirm-modal hidden">
  <div class="wishlist-modal-content">
    <p>Remove full items from your wishlist?</p>
    <div class="wishlist-modal-actions">
      <button id="wishlistClearAllConfirmYes">Yes</button>
      <button id="wishlistClearAllConfirmNo">Cancel</button>
    </div>
  </div>
</div>


<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>


<script>


async function clearAllWishlist () {
  const modal = document.getElementById('wishlistClearAllConfirmModal');
  const yesBtn = document.getElementById('wishlistClearAllConfirmYes');
  const noBtn = document.getElementById('wishlistClearAllConfirmNo');


        modal.classList.remove('hidden');

      yesBtn.onclick = async () => {
        modal.classList.add('hidden');
  try {
    const res = await fetch('/user/wishlist/clear', {method:'DELETE'})
    if(!res.ok) throw new Error((await res.json()).message || 'Failed')

    showGlobalToast('Wishlist cleared','success')
    setTimeout(()=>location.reload(),600)     
  } catch (err) {
    showGlobalToast(err.message,'error')
  }

}


  noBtn.onclick = () => modal.classList.add('hidden');




}




document.querySelectorAll('.whishlist-page-icon').forEach(btn => {
  btn.addEventListener('click', async function () {
    const productId = this.dataset.productId;
    const allButtons = document.querySelectorAll(`.whishlist-page-icon[data-product-id="${productId}"]`);

    const isActive = this.classList.contains('active');
    const modal = document.getElementById('wishlistConfirmModal');
    const yesBtn = document.getElementById('wishlistConfirmYes');
    const noBtn = document.getElementById('wishlistConfirmNo');

    const updateUI = (active) => {
      allButtons.forEach(el => {
        const path = el.querySelector('svg path');
        if (active) {
          el.classList.add('active', 'pulse-continuous');
          path.setAttribute('fill', '#e63946');
          path.setAttribute('stroke', '#e63946');

        } else {
          el.classList.remove('active', 'pulse-continuous');
          path.setAttribute('fill', 'none');
          path.setAttribute('stroke', '#000');
        }
      });
    };

    if (!isActive) {
      try {
        const res = await fetch('/user/wishlist/add', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ productId, variant: null })
        });

        const data = await res.json();
        if (res.ok) {

          window.location.reload()

          updateUI(true);
          showGlobalToast('Added to wishlist');
        } else {
          showGlobalToast(data.message || 'Failed', 'error');
        }
      } catch (err) {
        location.href = '/user/login';
      }
    } else {
      modal.classList.remove('hidden');

      yesBtn.onclick = async () => {
        modal.classList.add('hidden');
        try {
          const res = await fetch(`/user/wishlist/remove/${productId}`, {
            method: 'DELETE'
          });

          const data = await res.json();
          if (res.ok) {
              window.location.reload()
            updateUI(false);
            showGlobalToast('Removed from wishlist');
          } else {
            showGlobalToast(data.message || 'Failed to remove', 'error');
          }
        } catch (err) {
          showGlobalToast('Error removing', 'error');
        }
      };

      noBtn.onclick = () => modal.classList.add('hidden');
    }
  });
});

</script>


</body>

